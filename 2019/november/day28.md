# Day28

## 19.11.28 Thursday

## /proc/meminfo

free보다 더 자세하게 메모리 사용현황을 확인하는 방법은 `/proc/meminfo` 파일을 확인하는 것이다. 출력 값은 커널 버전에 따라 조금씩 다르게 나타나므로 대부분의 커널에서 공통적으로 나타나는 부분만 알아본다.

* SwapCached

  swap 영역으로 빠진 메모리 중 다시 메모리로 돌아온 영역을 의미한다.

  시스템은 메모리가 부족하다면 커널은 프로세스의 주소 공간 중 swap 영역으로 이동시킬 수 있는 메모리를 선택해서 swap 영역으로 이동시킨다. 이 후 메모리가 확보되면 이동시킨 부분을 다시 메모리에 적재한다. 이때 커널은 swap 영역에 해당 메모리 내용을 삭제하지 않는다. 이후 또다시 메모리 부족 문제가 발생할 것을 대비하는 것이다. 이를 통해 I/O를 조금이나마 줄일 수 있다.

* Active\(anon\)

  참고로 anon은 Anonymous의 준말이다. 여기서 Anonymous는 특정 파일의 내용을 저장하고 있는 Page Cache 영역을 제외한 메모리 영역을 의미한다. 즉, 프로세스들이 사용하는 메모리 영역을 지칭할 때 많이 사용된다. 그중에서도 비교적 최근에 메모리 참조되어 swap 영역으로 이동되지 않을 메모리 영역을 의미한다.

* InActive\(anon\)

  Active\(anon\)과 같이 영역을 의미하지만 비교적 참조된지 오래되어 Swap 영역으로 이동될 수 있는 메모리영역을 의미

* Active\(file\)

  anon과는 다르게 커널이 I/O 성능 향상을 위해 사용하는 영역이다. 즉, buffers와 cached 영역이 바로 Active\(file\)이다.

* InActive\(file\)

  Active\(file\)과 목적은 같지만 InActive라는 이름에서 알 수 있듯 참조된 지 오래되어 Swap 영역으로 이동될 수 있는 메모리 영역이다.

* Dirty

  I/O 성능 향상을 위해 커널이 캐시 목적으로 사용하는 영역 중 쓰기 작업이 이뤄져 실제 블록 디바이스의 블록에 씌어져야 할 영역을 의미한다. 커널은 I/O 요청이 올 때마다 블록 디바이스에 명령을 내리는 것이 아니라 일정 요청이 모일때까지 기다린 뒤에 한 번에 요청을 보낸다. 즉, 일종의 쓰기 지연 작업을 커널이 수행하는 것이다. 이 과정에서 사용되는 메모리 영역이 Dirty이다.

## Slab - 커널의 메모리 영역

커널도 프로세스의 일종이므로 메모리을 소모한다. 이때 커널이 소모하는 영역을 Slab으로 보여준다.

### 커널 관련 메모리 영역

* Slab

  메모리 영역 중 커널이 직접 사용하는 영역을 의미. 이 영역에는 dentry cache, inode cache 등 커널이 사용하는 메모리가 포함된다.

* SReclaimable

  Slab 영역 중 재사용될 수 있는 영역을 의미한다. 캐시 용도의 메모리들이 이 영역에 포함된다.

* SUnreclaim

  Slab 영역 중 재사용될 수 없는 영역이다. 커널이 현재 사용중인 영역이며 해제해서 다른 용도로 사용될 수 없다.

리눅스에서는 Slab 관련 정보를 `slabtop` 명령으로 확인할 수 있다.

