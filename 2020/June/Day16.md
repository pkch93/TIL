# 2020.06.16 Thursday - CQS Pattern

### Table of Contents

- [CQS 패턴](#CQS_Pattern)

## CQS Pattern

> 아래 내용은 조영호님의 [오브젝트](http://www.yes24.com/Product/Goods/74219491) 6장에 나오는 내용입니다.

명령-쿼리 분리 원칙은 인터페이스에 오퍼레이션을 정의할 때 참고할 수 있는 지침을 제공해준다.

### 프로시저와 함수

어떤 절차를 묶어 호출 가능하도록 이름을 부여한 기능 모듈을 **루틴**이라고 한다. 루틴은 세부적으로 **프로시저와 함수**로 구분할 수 있다.

프로시저는 정해진 절차에 따라 내부의 상태를 변경하는 루틴의 한 종류이다. 반면 함수는 어떤 절차에 따라 필요한 값을 계산해서 반환하는 루틴의 한 종류이다. 즉, 요약하면 다음과 같다. 

- 프로서저는 사이드이펙트를 유발하지만 값을 반환하지는 않는다.
- 함수는 값을 반환하지만 사이드이팩트를 유발할 수 없다.

명령과 쿼리도 객체의 인터페이스 측면에서 프로시저와 함수를 부르는 또 다른 이름이다. 객체의 상태를 수정하는 오퍼레이션을 명령, 객체와 관련된 정보를 반환하는 오퍼레이션을 쿼리라고 한다. 따라서 명령은 프로시저, 쿼리는 함수와 동일하다.

명령-쿼리 분리 원칙의 요지는 오퍼레이션은 부수효과를 발생시키는 명령이거나 부수효과를 발생시키지 않는 쿼리 둘 중 하나여야한다는 것이다. 

명령과 쿼리가 함께 존재하면 실행 결과를 예측하기 어려워진다. 잘못 사용하기 쉬우며 버그를 양산할 수 있다.

### 명령-쿼리 분리와 참조 투명성

명령과 쿼리를 분리함으로써 쿼리의 결과를 예측하기 쉬워지고 쿼리의 순서를 자유롭게 변경할 수도 있다. 이를 통해 참조 투명성의 장점을 제한적으로나마 누릴 수 있게 된다.

> 참조 투명성이란 어떤 표현식 e가 있을 때 e의 값으로 e가 나타나는 모든 위치를 교체하더라도 결과가 달라지지 않는 특성을 의미한다.

참조 투명성의 장점으로는 예측 가능한 코드로 만들 수 있으며 버그가 적고 디버깅이 용이해진다.

객체지향 패러다임이 객체의 상태 변경이라는 부수효과를 기반으로 하기 때문에 참조 투명성은 객체지향에서는 예외에 가깝다. 하지만 명령-쿼리 분리를 통해 조금이나마 이 예외를 줄여 조금이나마 참조 투명성의 혜택을 누릴 수 있도록 만들 수 있다.