# 2021.07.08 TIL - ELB와 대상 그룹

- [2021.07.08 TIL - ELB와 대상 그룹](#20210708-til---elb와-대상-그룹)
  - [ELB와 대상 그룹 `Target Group`](#elb와-대상-그룹-target-group)
    - [AWS ELB 작동 방식](#aws-elb-작동-방식)
    - [AWS ELB의 종류](#aws-elb의-종류)
  - [대상 그룹 `Target Group`](#대상-그룹-target-group)

## ELB와 대상 그룹 `Target Group`

로드밸런서란 다수의 서버에 유입되는 트래픽을 분산시켜서 워크로드의 균형을 잡기 위한 하드웨어를 가리킨다. 현대적인 다수의 애플리케이션은 웹 서버 앞에 로드 밸런서를 배치해 트래픽을 분산시키고 워크로드의 균형을 맞추며 탄력성을 증대시킨다. 다만 문제점도 있는데 대표적으로 로드밸런서가 단일장애지점 `SPOF` 이 될 수 있다는 점이다. 결국 고가용성을 위해서 로드밸런서도 이중화해서 관리해야하는 부담이 존재한다.

일래스틱 로드 밸런싱은 위와 같은 문제를 모두 해결할 수 있는 완전 관리형 서비스이며, 애플리케이션으로 유입되는 트래픽을 EC2 인스턴스에서 호스팅되고 있는 다수의 애플리케이션, 마이크로서비스, 컨테이너 등에 자동으로 분산시킨다.

### AWS ELB 작동 방식

![](https://user-images.githubusercontent.com/30178507/124915768-e16afc80-e02c-11eb-89dc-7bd3e53135f4.png)

위 캡처는 AWS ELB의 고가용성을 구현한 방식을 보여준다.

먼저 ELB가 다운될 가능성이 있는 경우를 살펴보면 내부적으로 각각의 ELB 인스턴스는 다중 AZ 환경에 구현되어 있다. 사용자가 다중 AZ에 애플리케이션을 배포하지 않더라도 ELB는 기본적으로 다중 AZ에 배포한다.

다중 AZ 환경에 개별 ELB VPC 내에 다수의 로드 밸런서 를 배포하는 방식으로 고가용성을 구현할 수 있으며, 사용자는 이를 위해 로드 밸런서에 대해 별도의 환경 설정 작업을 할 필요가 없다. AWS는 로드 밸런서와 관련된 모든 업무를 자동으로 관리하며, 이에 대한 별도의 비용을 청구하지 않는다. 즉, 사용자는 ELB를 이용해 별도의 고정 비용 없이 고가용성을 구현할 수 있다.

### AWS ELB의 종류

[https://www.notion.so/AWS-ELB-0fa6ebf2d7164d9e81c4be66389c683b](https://www.notion.so/AWS-ELB-0fa6ebf2d7164d9e81c4be66389c683b)

## 대상 그룹 `Target Group`

대상 그룹은 ELB의 로드 밸런싱 대상을 논리적으로 그루핑한 그룹을 의미한다.

타깃 그룹은 로드 밸런서와 별개로 존재할 수 있으며, 필요할 때를 대비해서 대상 그룹을 먼저 생성해 놓을 수 있다. 타깃 그룹에 관련 리소스를 계속 추가해 둘 수 있으며, 로드 밸런서 구현 시 갑자기 대상 그룹을 구성할 필요는 없다. 이후 필요 시 대상 그룹을 로드 밸런서에 연결할 수 있다. 대상 그룹은 리전을 기반으로 하므로, 대상 그룹이 있는 하나의 리전에서만 리소스를 할당할 수 있다. 대상 그룹은 Auto Scaling Group과도 잘 연결된다.

EC2 인스턴스, 마이크로서비스, ALB의 컨테이너 기반 애플리케이션, NLB의 인스턴스 또는 IP 주소가 타깃으로 사용될 수 있다. 타입이 IP인 경우, IP 주소는 디음 CIDR 블록 범위 내에서 지정할 수 있다.

- 대상 그룹의 VPC 서브넷
- 10.0.0.0/8
- 100.64.0.0/10
- 172.16.0.0/12
- 192.168.0.0/16

EC2 인스턴스의 경우는 다중 포트 이용 시 동일한 대상 그룹 이름으로 등록할 수 있고, 하나의 대상은 여러 대상 그룹에 등록될 수 있다.
